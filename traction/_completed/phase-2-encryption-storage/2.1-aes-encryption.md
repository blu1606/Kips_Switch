# 2.1 AES Encryption (Client-Side)

## Mục tiêu
Implement mã hóa/giải mã AES-GCM hoàn toàn trong browser, đảm bảo Zero-Knowledge.

## Encryption Strategy

### Key Generation
```
User signs message → SHA-256(signature) → AES Key (256-bit)
```
- Dùng wallet signature làm entropy
- Hash để tạo key 256-bit cố định

### Algorithm: AES-GCM
- Mode: GCM (Galois/Counter Mode)
- Key size: 256-bit
- IV: Random 12 bytes mỗi lần encrypt

## Core Functions

### `encryptFile(file: File, key: string): EncryptedData`
1. Read file as ArrayBuffer
2. Generate random IV (12 bytes)
3. Encrypt với AES-GCM
4. Return: `{ ciphertext, iv }` (base64)

### `decryptFile(encryptedData: EncryptedData, key: string): Blob`
1. Decode ciphertext và IV từ base64
2. Decrypt với AES-GCM
3. Return Blob để download

### `encryptKeyForRecipient(aesKey: string, recipientPubkey: string): string`
- Encrypt AES key cho recipient wallet
- MVP: Có thể dùng TweetNaCl box hoặc simplified approach

## Library Choice
- **Option 1:** `crypto-js` - simple, phổ biến
- **Option 2:** Web Crypto API (native) - performant hơn
- **Recommend:** Web Crypto API cho file lớn

## Security Checklist
- [ ] Key không bao giờ gửi lên server
- [ ] IV unique mỗi lần encrypt
- [ ] Plaintext không log ra console

## Acceptance Criteria
- [ ] Encrypt "Hello World" → ciphertext khác nhau mỗi lần (random IV)
- [ ] Decrypt với đúng key → trả về "Hello World"
- [ ] Decrypt với sai key → throw error
