# 12.2 Multi-Recipient Vault

> **Goal:** Split inheritance between multiple people  
> **Priority:** P2 (v2 feature)  
> **Complexity:** High (contract changes needed)

---

## ğŸ¯ User Psychology

**Use case:** "TÃ´i muá»‘n chia cho 3 ngÆ°á»i"

| Scenario | User Intent |
|----------|-------------|
| "Chia Ä‘á»u 3 con" | Equal 33/33/33 |
| "Vá»£ chÃ­nh, con phá»¥" | Weighted 60/20/20 |
| "Má»—i ngÆ°á»i tÃ i sáº£n khÃ¡c" | Asset-specific |

---

## ğŸ’¡ Approach Options (Debated)

### âŒ Option A: Percentage Split (On-chain)
```
Vault: 10 SOL
Recipients: [Son:40%, Daughter:30%, Wife:30%]
```
- Complex contract change
- NFTs indivisible (problem!)
- Gas for multiple transfers

### âŒ Option B: Multiple Keys (Race condition)
```
First come = first served
```
- Family drama guaranteed
- Not "inheritance" behavior

### âœ… Option C: Virtual Sub-Vaults (Recommended)
```
User creates "bundle" of 3 vaults
Each vault: own recipient, own content
Same check-in timer for all
```
- Uses existing contract
- Clean separation
- Asset-specific possible

---

## ğŸ“ Proposed UI Flow

```
Create Wizard Step: "Recipients"
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ How many people will inherit?                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â—‹ One person (simple)                                   â”‚
â”‚ â— Multiple people (create sub-vaults)                   â”‚
â”‚                                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ‘¤ Son           â”‚ 4.0 SOL    â”‚ 40%  â”‚ [Edit]     â”‚ â”‚
â”‚ â”‚ ğŸ‘¤ Daughter      â”‚ 3.0 SOL    â”‚ 30%  â”‚ [Edit]     â”‚ â”‚
â”‚ â”‚ ğŸ‘¤ Wife          â”‚ 3.0 SOL    â”‚ 30%  â”‚ [Edit]     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                         â”‚
â”‚ [+ Add Recipient]                   Total: 10 SOL       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ Technical Design

### Bundle Entity (Off-chain)
```typescript
interface VaultBundle {
  id: string;
  name: string;
  createdAt: Date;
  checkInInterval: number; // Shared timer
  vaults: Vault[];         // Linked vaults
}
```

### On-chain: No change needed
- Each sub-vault is independent Vault PDA
- Shared: same owner, same timer
- Different: recipient, content

### Check-in: One click = all vaults
```
Owner check-in â†’ Update all vault PDAs in bundle
```

---

## âš ï¸ Edge Cases

| Case | Solution |
|------|----------|
| Different timers per recipient? | Not allowed (complexity) |
| Partial claim? | Each vault independent |
| Add recipient later? | Create new vault, link to bundle |
| NFT splitting? | One NFT = one vault |

---

## âœ… Execution Checklist (v2)

- [ ] Design bundle data model
- [ ] Create "split vault" UI in wizard
- [ ] Implement batch check-in
- [ ] Test with 3-recipient scenario
- [ ] Handle edge cases
